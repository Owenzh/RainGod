{% extends "admin/bases.html" %}
<!-- {% import "admin/fy.html" as pg %} -->

{% block content %}


<div class="x-body">
  <div class="layui-row">
    <!-- <p>house管理页面</p> -->
    <table class="layui-table" lay-data="{height:800, data:{{jsonData}},toolbar: 'default',page:true, id:'test'}" lay-filter="test">
      <thead>
        <tr>
            <th lay-data="{type:'checkbox'}">ID</th>
          <th lay-data="{field:'id', width:60, sort: true}">ID</th>
          <th lay-data="{field:'roomno', width:90,sort: true}">房间号</th>
          <th lay-data="{field:'house_type', width:100,sort: true}">房屋类型</th>
          <th lay-data="{field:'squares', width:80,sort: true}">面积</th>
          <th lay-data="{field:'house_by_dt', width:120,sort: true}">购买日期</th>
          <th lay-data="{field:'house_cert', width:100,sort: true}">房屋证明</th>
          <th lay-data="{field:'active', width:90,sort: true}">有效</th>
          <th lay-data="{field:'loupan_id', sort: true}">楼盘号</th>
        </tr>
      </thead>
    </table>
    <script type="text/html" id="toolbarDemo">
      <div class="layui-btn-container">
        <button class="layui-btn layui-btn-sm" lay-event="getCheckData">获取选中行数据</button>
        <button class="layui-btn layui-btn-sm" lay-event="getCheckLength">获取选中数目</button>
        <button class="layui-btn layui-btn-sm" lay-event="isAll">验证是否全选</button>
      </div>
    </script>
     
    <script type="text/html" id="barDemo">
      <a class="layui-btn layui-btn-xs" lay-event="edit">编辑</a>
      <a class="layui-btn layui-btn-danger layui-btn-xs" lay-event="del">删除</a>
    </script>

  </div>
<div>

    <script type="text/javascript" src="//layui.hcwl520.com.cn/layui-v2.4.5/layui.js?v=201811010202" charset="utf-8"></script>
    <script>
      console.log($('#testdata').val());
layui.use('table', function(){
  var table = layui.table;
  table.on('toolbar(test)', function(obj){
    var checkStatus = table.checkStatus(obj.config.id)
    ,data = checkStatus.data; //获取选中的数据
    switch(obj.event){
      case 'add':
        layer.open({
            title: '户管理',
            type: 2,
            skin: 'layui-layer-rim', //加上边框
            area: ['40%', '600px'], //宽高
            content: ['/admin/householdmgr_change','no'], //弹出的页面
            shadeClose: true, //点击遮罩关闭
            // success: function (layero, index) {
            //     var body = layer.getChildFrame('body', index);
            //     var iframeWin = window[layero.find('iframe')[0]['name']]; //得到iframe页的窗口对象，执行iframe页的方法：iframeWin.method();
            //     //console.log(body.html()) //得到iframe页的body内容
            //     //初始化表单数据的值
            //     body.find(".classifyid").val(classifyid); //要修改的每个td的值存为变量传进去
            //     body.find(".s_name").val(s_name);
            //     body.find(".phone").val(phone);
            //     body.find(".city").val(city);
            //     body.find(".country").val(country);
            //     body.find(".postcode").val(postcode);
            //     body.find(".address").val(address);
            //     body.find(".address2").val(address2);
            // }
        });
      break;
      case 'update':
        if(data.length === 0){
          layer.msg('请选择一行');
        } else if(data.length > 1){
          layer.msg('只能同时编辑一个');
        } else {
          layer.alert('编辑 [id]：'+ checkStatus.data[0].id);
        }
      break;
      case 'delete':
        if(data.length === 0){
          layer.msg('请选择一行');
        } else {
          layer.msg('删除');
        }
      break;
    };
  });
  
  //监听行工具事件
  table.on('tool(test)', function(obj){ //注：tool 是工具条事件名，test 是 table 原始容器的属性 lay-filter="对应的值"
    var data = obj.data //获得当前行数据
    ,layEvent = obj.event; //获得 lay-event 对应的值
    if(layEvent === 'detail'){
      layer.msg('查看操作');
    } else if(layEvent === 'del'){
      layer.confirm('真的删除行么', function(index){
        obj.del(); //删除对应行（tr）的DOM结构
        layer.close(index);
        //向服务端发送删除指令
      });
    } else if(layEvent === 'edit'){
      layer.msg('编辑操作');
    }
  });
});
        </script>
</div>

</div>

{% endblock %}